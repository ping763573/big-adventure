<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全球空氣質量監测平台 | Global Air Quality Monitor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css">
    <style>
        /* 原有样式保持不变 */
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #1abc9c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gradient-start: #1a2980;
            --gradient-end: #26d0ce;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft JhengHei', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: #fff;
            min-height: 100vh;
            padding-bottom: 2rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            padding: 2rem 0;
            text-align: center;
            position: relative;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .update-time {
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 15px;
            border-radius: 30px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .update-time i {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .lang-switch {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            padding: 8px 20px;
            border-radius: 30px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .lang-switch:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        
        .logo {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .logo i {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto 1.5rem;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 2rem 0;
        }
        
        .summary-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .summary-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .summary-card .value {
            font-size: 3rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }
        
        .aqi-excellent { color: var(--success); }
        .aqi-good { color: #9bde34; }
        .aqi-moderate { color: #f1c40f; }
        .aqi-poor { color: var(--warning); }
        .aqi-very-poor { color: #e67e22; }
        .aqi-severe { color: var(--danger); }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 2rem 0;
        }
        
        @media (max-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .panel-title {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
        }
        
        select, button {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        select:hover, button:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        select:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }
        
        .city-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 1rem;
        }
        
        .city-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .city-card:hover {
            transform: translateY(-5px);
        }
        
        .city-card-header {
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .city-name {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .city-aqi {
            font-size: 1.8rem;
            font-weight: 700;
            padding: 10px 15px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .city-pollutants {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.1);
        }
        
        .pollutant {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .pollutant:last-child {
            border-bottom: none;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
            margin-top: 1rem;
        }
        
        .alert-container {
            margin-top: 1.5rem;
            background: rgba(231, 76, 60, 0.2);
            border-radius: 10px;
            padding: 1rem;
            border-left: 4px solid var(--danger);
        }
        
        .alert-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: var(--danger);
        }
        
        .alert-cities {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .alert-city {
            background: rgba(231, 76, 60, 0.3);
            padding: 5px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .alert-level-high {
            background: rgba(243, 156, 18, 0.3);
            border-left: 4px solid var(--warning);
        }
        
        .alert-level-high .alert-header {
            color: var(--warning);
        }
        
        .alert-level-high .alert-city {
            background: rgba(243, 156, 18, 0.3);
        }
        
        .map-container {
            height: 350px;
            border-radius: 12px;
            overflow: hidden;
            margin-top: 1rem;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .tab.active {
            background: rgba(255, 255, 255, 0.25);
            font-weight: 600;
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .data-source {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .source-logo {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .view-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .view-option {
            padding: 8px 15px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .view-option.active {
            background: rgba(255, 255, 255, 0.25);
        }
        
        .lang-zh, .lang-en {
            display: none;
        }
        
        .lang-zh.active, .lang-en.active {
            display: block;
        }
        
        .data-timestamp {
            font-size: 0.85rem;
            opacity: 0.7;
            margin-top: 5px;
            text-align: center;
        }
        
        .no-alert {
            background: rgba(46, 204, 113, 0.2);
            border-left: 4px solid var(--success);
            text-align: center;
            padding: 1rem;
            border-radius: 10px;
        }
        
        .no-alert .alert-header {
            color: var(--success);
            justify-content: center;
        }
        
        /* 新增的污染物说明样式 */
        .pollutant-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .pollutant-info-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            margin-bottom: 1rem;
        }
        
        .pollutant-info-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .pollutant-info-content {
            display: none;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .pollutant-info.active .pollutant-info-content {
            display: block;
        }
        
        .pollutant-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .pollutant-card {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 1rem;
        }
        
        .pollutant-card h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: var(--info);
        }
        
        .pollutant-card p {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        
        .pollutant-card ul {
            padding-left: 1.5rem;
            margin-top: 0.5rem;
        }
        
        .pollutant-card li {
            margin-bottom: 0.3rem;
        }
        
        /* 新增的筛选状态显示 */
        .filter-status {
            margin-top: 1rem;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        /* 新增的音乐播放器样式 */
        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .music-player:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .music-control {
            background: none;
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .music-control:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .music-info {
            font-size: 0.9rem;
            max-width: 0;
            overflow: hidden;
            transition: max-width 0.5s ease, opacity 0.3s ease;
            opacity: 0;
            white-space: nowrap;
        }
        
        .music-player.expanded .music-info {
            max-width: 200px;
            opacity: 1;
        }
        
        .volume-control {
            width: 0;
            overflow: hidden;
            transition: width 0.3s ease;
        }
        
        .music-player.expanded .volume-control {
            width: 100px;
        }
        
        .music-player.expanded {
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .music-title {
            font-weight: 600;
            margin-right: 10px;
        }
        
        .now-playing {
            display: flex;
            align-items: center;
        }
        
        .equalizer {
            display: flex;
            align-items: flex-end;
            height: 20px;
            gap: 2px;
            margin-right: 8px;
        }
        
        .bar {
            width: 2px;
            background: var(--info);
            border-radius: 1px;
            animation: equalize 1.2s infinite ease-in-out;
        }
        
        .bar:nth-child(1) { height: 40%; animation-delay: 0s; }
        .bar:nth-child(2) { height: 70%; animation-delay: 0.2s; }
        .bar:nth-child(3) { height: 30%; animation-delay: 0.4s; }
        .bar:nth-child(4) { height: 60%; animation-delay: 0.6s; }
        .bar:nth-child(5) { height: 50%; animation-delay: 0.8s; }
        
        @keyframes equalize {
            0%, 100% { transform: scaleY(0.8); }
            50% { transform: scaleY(1.2); }
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .music-player {
                left: 20px;
                right: auto;
            }
            
            .music-player.expanded {
                width: calc(100% - 40px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="update-time">
                    <i class="fas fa-sync-alt"></i>
                    <span id="updateTime">2025年7月27日 10:00:00 UTC</span>
                </div>
                <button id="langSwitch" class="lang-switch">
                    <i class="fas fa-language"></i>
                    <span class="lang-zh active">English</span>
                    <span class="lang-en">中文</span>
                </button>
            </div>
            
            <div class="logo">
                <i class="fas fa-globe-asia"></i>
                <h1>
                    <span class="lang-zh active">全球空氣質量監测平台</span>
                    <span class="lang-en">Global Air Quality Monitor</span>
                </h1>
            </div>
            <p class="subtitle">
                <span class="lang-zh active">實時追踪全球主要城市的空氣質量指標，包括PM2.5、PM10、NO₂、CO等污染物数據</span>
                <span class="lang-en">Real-time tracking of air quality indicators in major global cities, including pollutants such as PM2.5, PM10, NO₂, CO</span>
            </p>
            
            <!-- 新增的污染物说明区域 -->
            <div class="pollutant-info">
                <div class="pollutant-info-header">
                    <h3>
                        <i class="fas fa-info-circle"></i>
                        <span class="lang-zh active">污染物定義與健康影響</span>
                        <span class="lang-en">Pollutant Definitions & Health Impacts</span>
                    </h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="pollutant-info-content">
                    <div class="pollutant-info-grid">
                        <div class="pollutant-card">
                            <h4>
                                <i class="fas fa-wind"></i>
                                <span>AQI</span>
                            </h4>
                            <p>
                                <span class="lang-zh active">空氣質量指數，綜合多種污染物濃度計算出的指標，反映空氣污染程度。</span>
                                <span class="lang-en">Air Quality Index, a composite indicator calculated from multiple pollutant concentrations, reflecting air pollution levels.</span>
                            </p>
                            <p>
                                <span class="lang-zh active">健康影響：數值越高對健康影響越大，敏感人群應避免戶外活動。</span>
                                <span class="lang-en">Health Impact: Higher values indicate greater health risks; sensitive groups should avoid outdoor activities.</span>
                            </p>
                        </div>
                        <div class="pollutant-card">
                            <h4>
                                <i class="fas fa-microscope"></i>
                                <span>PM2.5</span>
                            </h4>
                            <p>
                                <span class="lang-zh active">空氣中直徑小於或等於2.5微米的顆粒物，可深入人體呼吸系統。</span>
                                <span class="lang-en">Particulate matter with a diameter of 2.5 micrometers or less, which can penetrate deep into the respiratory system.</span>
                            </p>
                            <p>
                                <span class="lang-zh active">主要來源：工業排放、交通廢氣、燃煤等。</span>
                                <span class="lang-en">Main Sources: Industrial emissions, vehicle exhaust, coal combustion.</span>
                            </p>
                            <p>
                                <span class="lang-zh active">健康影響：心血管疾病、呼吸系統疾病、肺癌等。</span>
                                <span class="lang-en">Health Impact: Cardiovascular diseases, respiratory diseases, lung cancer.</span>
                            </p>
                        </div>
                        <div class="pollutant-card">
                            <h4>
                                <i class="fas fa-cloud"></i>
                                <span>PM10</span>
                            </h4>
                            <p>
                                <span class="lang-zh active">空氣中直徑小於或等於10微米的顆粒物，可被人體吸入。</span>
                                <span class="lang-en">Particulate matter with a diameter of 10 micrometers or less, which can be inhaled into the human body.</span>
                            </p>
                            <p>
                                <span class="lang-zh active">主要來源：建築揚塵、道路灰塵、工業排放等。</span>
                                <span class="lang-en">Main Sources: Construction dust, road dust, industrial emissions.</span>
                            </p>
                            <p>
                                <span class="lang-zh active">健康影響：呼吸道刺激、哮喘加重、支氣管炎等。</span>
                                <span class="lang-en">Health Impact: Respiratory irritation, aggravated asthma, bronchitis.</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>
                        <i class="fas fa-globe-americas"></i>
                        <span class="lang-zh active">全球平均AQI</span>
                        <span class="lang-en">Global Avg AQI</span>
                    </h3>
                    <div class="value aqi-moderate">58.2</div>
                    <p>
                        <span class="lang-zh active">中等污染水平</span>
                        <span class="lang-en">Moderate pollution</span>
                    </p>
                    <div class="data-timestamp">
                        <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                        <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h3>
                        <i class="fas fa-tree"></i>
                        <span class="lang-zh active">最清潔城市</span>
                        <span class="lang-en">Cleanest City</span>
                    </h3>
                    <div class="value aqi-excellent">
                        <span class="lang-zh active">倫敦</span>
                        <span class="lang-en">London</span>
                    </div>
                    <p>
                        <span class="lang-zh active">AQI: 25 (優良)</span>
                        <span class="lang-en">AQI: 25 (Excellent)</span>
                    </p>
                    <div class="data-timestamp">
                        <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                        <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h3>
                        <i class="fas fa-smog"></i>
                        <span class="lang-zh active">污染最嚴重城市</span>
                        <span class="lang-en">Most Polluted City</span>
                    </h3>
                    <div class="value aqi-severe">
                        <span class="lang-zh active">雅加達</span>
                        <span class="lang-en">Jakarta</span>
                    </div>
                    <p>
                        <span class="lang-zh active">AQI: 110 (不健康)</span>
                        <span class="lang-en">AQI: 110 (Unhealthy)</span>
                    </p>
                    <div class="data-timestamp">
                        <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                        <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h3>
                        <i class="fas fa-heartbeat"></i>
                        <span class="lang-zh active">WHO達標城市</span>
                        <span class="lang-en">WHO Compliant Cities</span>
                    </h3>
                    <div class="value">30.0%</div>
                    <p>
                        <span class="lang-zh active">符合PM2.5标準</span>
                        <span class="lang-en">Meet PM2.5 standards</span>
                    </p>
                    <div class="data-timestamp">
                        <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                        <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="dashboard">
            <div class="panel">
                <div class="panel-header">
                    <h3 class="panel-title">
                        <i class="fas fa-city"></i>
                        <span class="lang-zh active">城市空氣質量</span>
                        <span class="lang-en">City Air Quality</span>
                    </h3>
                    <div class="controls">
                        <select id="regionFilter">
                            <option value="all">
                                <span class="lang-zh active">所有地區</span>
                                <span class="lang-en">All Regions</span>
                            </option>
                            <option value="asia">
                                <span class="lang-zh active">亞洲</span>
                                <span class="lang-en">Asia</span>
                            </option>
                            <option value="europe">
                                <span class="lang-zh active">歐洲</span>
                                <span class="lang-en">Europe</span>
                            </option>
                            <option value="north-america">
                                <span class="lang-zh active">北美洲</span>
                                <span class="lang-en">North America</span>
                            </option>
                            <option value="south-america">
                                <span class="lang-zh active">南美洲</span>
                                <span class="lang-en">South America</span>
                            </option>
                            <option value="africa">
                                <span class="lang-zh active">非洲</span>
                                <span class="lang-en">Africa</span>
                            </option>
                            <option value="oceania">
                                <span class="lang-zh active">大洋洲</span>
                                <span class="lang-en">Oceania</span>
                            </option>
                        </select>
                        <div class="view-toggle">
                            <div class="view-option active"><i class="fas fa-th"></i></div>
                            <div class="view-option"><i class="fas fa-list"></i></div>
                        </div>
                    </div>
                </div>
                
                <div class="filter-status">
                    <span class="lang-zh active">顯示全部城市</span>
                    <span class="lang-en">Showing all cities</span>
                </div>
                
                <div class="city-cards">
                    <!-- 台北 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">台北</span>
                                <span class="lang-en">Taipei</span>
                            </div>
                            <div class="city-aqi aqi-good">41</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>10 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>18 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>8 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>281 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 東京 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">東京</span>
                                <span class="lang-en">Tokyo</span>
                            </div>
                            <div class="city-aqi aqi-good">33</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>8 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>14 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>7 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>300 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 德里 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">德里</span>
                                <span class="lang-en">Delhi</span>
                            </div>
                            <div class="city-aqi aqi-moderate">85</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>32 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>96 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>9 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>546 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 雪梨 -->
                    <div class="city-card" data-region="oceania">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">雪梨</span>
                                <span class="lang-en">Sydney</span>
                            </div>
                            <div class="city-aqi aqi-good">27</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>9 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>18 µg/m³</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 北京 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">北京</span>
                                <span class="lang-en">Beijing</span>
                            </div>
                            <div class="city-aqi aqi-moderate">51</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>15 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>30 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>6 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>350 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 首爾 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">首爾</span>
                                <span class="lang-en">Seoul</span>
                            </div>
                            <div class="city-aqi aqi-good">42</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>7 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>19 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>12 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>278 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 曼谷 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">曼谷</span>
                                <span class="lang-en">Bangkok</span>
                            </div>
                            <div class="city-aqi aqi-moderate">56</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>14 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>37 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>18 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>180 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 河内 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">河内</span>
                                <span class="lang-en">Hanoi</span>
                            </div>
                            <div class="city-aqi aqi-moderate">45</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>15 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>35 µg/m³</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 新加坡 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">新加坡</span>
                                <span class="lang-en">Singapore</span>
                            </div>
                            <div class="city-aqi aqi-moderate">60</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>16 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>27 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>16 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>187 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 雅加達 -->
                    <div class="city-card" data-region="asia">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">雅加達</span>
                                <span class="lang-en">Jakarta</span>
                            </div>
                            <div class="city-aqi aqi-very-poor">110</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>30 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>42 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>18 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>35 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 洛杉磯 -->
                    <div class="city-card" data-region="north-america">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">洛杉磯</span>
                                <span class="lang-en">Los Angeles</span>
                            </div>
                            <div class="city-aqi aqi-moderate">60</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>18 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>47 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>29 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>430 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 倫敦 -->
                    <div class="city-card" data-region="europe">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">倫敦</span>
                                <span class="lang-en">London</span>
                            </div>
                            <div class="city-aqi aqi-excellent">25</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>5 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>8 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>6 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>154 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 巴黎 -->
                    <div class="city-card" data-region="europe">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">巴黎</span>
                                <span class="lang-en">Paris</span>
                            </div>
                            <div class="city-aqi aqi-moderate">75</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>25 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>41 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>31 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>51 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 柏林 -->
                    <div class="city-card" data-region="europe">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">柏林</span>
                                <span class="lang-en">Berlin</span>
                            </div>
                            <div class="city-aqi aqi-moderate">50</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>12 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>12 µg/m³</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 莫斯科 -->
                    <div class="city-card" data-region="europe">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">莫斯科</span>
                                <span class="lang-en">Moscow</span>
                            </div>
                            <div class="city-aqi aqi-good">42</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>10 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>21 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>9 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>169 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 紐約 -->
                    <div class="city-card" data-region="north-america">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">紐約</span>
                                <span class="lang-en">New York</span>
                            </div>
                            <div class="city-aqi aqi-good">29</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>5 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>15 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>6 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>134 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 墨西哥城 -->
                    <div class="city-card" data-region="north-america">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">墨西哥城</span>
                                <span class="lang-en">Mexico City</span>
                            </div>
                            <div class="city-aqi aqi-moderate">56</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>12 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>26 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>18 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>498 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 聖保羅 -->
                    <div class="city-card" data-region="south-america">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">聖保羅</span>
                                <span class="lang-en">Sao Paulo</span>
                            </div>
                            <div class="city-aqi aqi-good">37</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>12 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>23 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>13 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>226 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 開羅 -->
                    <div class="city-card" data-region="africa">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">開羅</span>
                                <span class="lang-en">Cairo</span>
                            </div>
                            <div class="city-aqi aqi-moderate">63</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>16 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>40 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>NO₂</span>
                                <span>7 ppb</span>
                            </div>
                            <div class="pollutant">
                                <span>CO</span>
                                <span>311 ppb</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                    
                    <!-- 約翰尼斯堡 -->
                    <div class="city-card" data-region="africa">
                        <div class="city-card-header">
                            <div class="city-name">
                                <span class="lang-zh active">約翰尼斯堡</span>
                                <span class="lang-en">Johannesburg</span>
                            </div>
                            <div class="city-aqi aqi-moderate">92</div>
                        </div>
                        <div class="city-pollutants">
                            <div class="pollutant">
                                <span>PM2.5</span>
                                <span>20 µg/m³</span>
                            </div>
                            <div class="pollutant">
                                <span>PM10</span>
                                <span>44 µg/m³</span>
                            </div>
                        </div>
                        <div class="data-timestamp">
                            <span class="lang-zh active">更新時間: 2025-07-27 10:00 UTC</span>
                            <span class="lang-en">Updated: 2025-07-27 10:00 UTC</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h3 class="panel-title">
                        <i class="fas fa-chart-line"></i>
                        <span class="lang-zh active">污染趨勢分析</span>
                        <span class="lang-en">Pollution Trend</span>
                    </h3>
                    <div class="controls">
                        <select id="pollutantSelect">
                            <option value="pm25">PM2.5</option>
                            <option value="pm10">PM10</option>
                            <option value="no2">NO₂</option>
                            <option value="co">CO</option>
                        </select>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
                <div class="data-timestamp" style="text-align: right; padding-right: 10px;">
                    <span class="lang-zh active">數據時間: 2025-07-20 至 2025-07-27</span>
                    <span class="lang-en">Data period: 2025-07-20 to 2025-07-27</span>
                </div>
                
                <div class="no-alert">
                    <div class="alert-header">
                        <i class="fas fa-check-circle"></i>
                        <h4>
                            <span class="lang-zh active">目前無嚴重污染警報</span>
                            <span class="lang-en">No Severe Pollution Alerts</span>
                        </h4>
                    </div>
                    <p>
                        <span class="lang-zh active">所有城市AQI均低於150，空氣品質處於可接受範圍</span>
                        <span class="lang-en">All cities have AQI below 150, air quality is acceptable</span>
                    </p>
                </div>
            </div>
        </div>
        
        <div class="panel">
            <div class="panel-header">
                <h3 class="panel-title">
                    <i class="fas fa-map-marked-alt"></i>
                    <span class="lang-zh active">全球空氣質量熱力圖</span>
                    <span class="lang-en">Global Air Quality Heatmap</span>
                </h3>
                <div class="tabs">
                    <div class="tab active">PM2.5</div>
                    <div class="tab">PM10</div>
                    <div class="tab">NO₂</div>
                    <div class="tab">CO</div>
                </div>
            </div>
            
            <div class="map-container" id="map"></div>
            <div class="data-timestamp" style="text-align: right; padding-right: 10px;">
                <span class="lang-zh active">數據時間: 2025-07-27 10:00 UTC</span>
                <span class="lang-en">Data time: 2025-07-27 10:00 UTC</span>
            </div>
        </div>
        
        <footer>
            <p>
                <span class="lang-zh active">全球空氣質量監测平台 © 2025 | 實時數據更新</span>
                <span class="lang-en">Global Air Quality Monitor © 2025 | Real-time Data</span>
            </p>
            <div class="data-source">
                <div class="source-logo">
                    <i class="fas fa-database"></i>
                    <span>
                        <span class="lang-zh active">數據來源: OpenAQ, WAQI, AirNow</span>
                        <span class="lang-en">Data Sources: OpenAQ, WAQI, AirNow</span>
                    </span>
                </div>
                <div class="source-logo">
                    <i class="fas fa-sync-alt"></i>
                    <span id="lastUpdated">
                        <span class="lang-zh active">最後更新: 2025-07-27 10:00 UTC</span>
                        <span class="lang-en">Last Updated: 2025-07-27 10:00 UTC</span>
                    </span>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- 新增的音乐播放器 -->
    <div class="music-player" id="musicPlayer">
        <div class="equalizer">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <button class="music-control" id="playPauseBtn">
            <i class="fas fa-play"></i>
        </button>
        <div class="music-info">
            <span class="music-title">Big Adventure</span>
            <span class="now-playing">
                <span class="lang-zh active">播放中</span>
                <span class="lang-en">Now Playing</span>
            </span>
        </div>
        <div class="volume-control">
            <input type="range" min="0" max="1" step="0.01" value="0.5" id="volumeControl">
        </div>
    </div>

    <script>
        // 设置当前语言
        let currentLang = 'zh';
        
        // 污染物说明区域的展开/折叠功能
        const pollutantInfo = document.querySelector('.pollutant-info');
        const pollutantInfoHeader = document.querySelector('.pollutant-info-header');
        
        pollutantInfoHeader.addEventListener('click', function() {
            pollutantInfo.classList.toggle('active');
            const icon = this.querySelector('i.fa-chevron-down');
            if (pollutantInfo.classList.contains('active')) {
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        });
        
        // 语言切换功能
        document.getElementById('langSwitch').addEventListener('click', function() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            
            // 切换显示的元素
            document.querySelectorAll('.lang-zh, .lang-en').forEach(el => {
                el.classList.remove('active');
            });
            
            document.querySelectorAll(`.lang-${currentLang}`).forEach(el => {
                el.classList.add('active');
            });
            
            // 更新按钮文本
            const switchText = currentLang === 'zh' ? 'English' : '中文';
            document.querySelector('#langSwitch .lang-zh').textContent = currentLang === 'zh' ? 'English' : '中文';
            document.querySelector('#langSwitch .lang-en').textContent = currentLang === 'zh' ? 'English' : '中文';
            
            // 更新图表
            updateChartLabels();
            
            // 更新地图标记
            updateMapMarkers();
            
            // 更新图例
            updateLegend();
            
            // 更新筛选状态
            updateFilterStatus();
        });
        
        // 更新当前时间
        function updateDateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'UTC',
                timeZoneName: 'short'
            };
            
            // 中文格式
            const zhDateTime = now.toLocaleString('zh-TW', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'UTC',
                timeZoneName: 'short'
            }).replace('GMT', 'UTC');
            
            // 英文格式
            const enDateTime = now.toLocaleString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'UTC',
                timeZoneName: 'short'
            }).replace('GMT', 'UTC');
            
            // 更新页面上的时间显示
            document.getElementById('updateTime').textContent = currentLang === 'zh' ? zhDateTime : enDateTime;
            document.getElementById('lastUpdated').innerHTML = currentLang === 'zh' ? 
                `最后更新: ${zhDateTime}` : `Last Updated: ${enDateTime}`;
        }
        
        // 初始化更新时间
        updateDateTime();
        
        // 每秒更新时间
        setInterval(updateDateTime, 1000);
        
        // 初始化趋势图表
        const ctx = document.getElementById('trendChart').getContext('2d');
        let trendChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['07/20', '07/21', '07/22', '07/23', '07/24', '07/25', '07/26'],
                datasets: [
                    {
                        label: currentLang === 'zh' ? '台北' : 'Taipei',
                        data: [40, 42, 45, 43, 41, 42, 41],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: currentLang === 'zh' ? '雅加達' : 'Jakarta',
                        data: [105, 108, 112, 110, 115, 113, 110],
                        borderColor: '#f39c12',
                        backgroundColor: 'rgba(243, 156, 18, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: currentLang === 'zh' ? '東京' : 'Tokyo',
                        data: [35, 33, 32, 31, 30, 32, 33],
                        borderColor: '#2ecc71',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: '#fff'
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: 'rgba(0, 0, 0, 0.7)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 1
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        },
                        ticks: {
                            color: '#fff'
                        },
                        title: {
                            display: true,
                            text: 'AQI',
                            color: '#fff'
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        },
                        ticks: {
                            color: '#fff'
                        },
                        title: {
                            display: true,
                            text: currentLang === 'zh' ? '日期' : 'Date',
                            color: '#fff'
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
        
        // 更新图表标签
        function updateChartLabels() {
            if (trendChart) {
                trendChart.destroy();
            }
            
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['07/20', '07/21', '07/22', '07/23', '07/24', '07/25', '07/26'],
                    datasets: [
                        {
                            label: currentLang === 'zh' ? '台北' : 'Taipei',
                            data: [40, 42, 45, 43, 41, 42, 41],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: currentLang === 'zh' ? '雅加達' : 'Jakarta',
                            data: [105, 108, 112, 110, 115, 113, 110],
                            borderColor: '#f39c12',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: currentLang === 'zh' ? '東京' : 'Tokyo',
                            data: [35, 33, 32, 31, 30, 32, 33],
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(255, 255, 255, 0.1)',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#fff'
                            },
                            title: {
                                display: true,
                                text: 'AQI',
                                color: '#fff'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#fff'
                            },
                            title: {
                                display: true,
                                text: currentLang === 'zh' ? '日期' : 'Date',
                                color: '#fff'
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }
        
        // 初始化地图
        const map = L.map('map').setView([20, 0], 2);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // 添加城市标记
        const cities = [
            {name: "台北", enName: "Taipei", lat: 25.0330, lng: 121.5654, aqi: 41, region: "asia"},
            {name: "東京", enName: "Tokyo", lat: 35.6762, lng: 139.6503, aqi: 33, region: "asia"},
            {name: "德里", enName: "Delhi", lat: 28.6139, lng: 77.2090, aqi: 85, region: "asia"},
            {name: "北京", enName: "Beijing", lat: 39.9042, lng: 116.4074, aqi: 51, region: "asia"},
            {name: "首爾", enName: "Seoul", lat: 37.5665, lng: 126.9780, aqi: 42, region: "asia"},
            {name: "曼谷", enName: "Bangkok", lat: 13.7563, lng: 100.5018, aqi: 56, region: "asia"},
            {name: "河内", enName: "Hanoi", lat: 21.0285, lng: 105.8542, aqi: 45, region: "asia"},
            {name: "新加坡", enName: "Singapore", lat: 1.3521, lng: 103.8198, aqi: 60, region: "asia"},
            {name: "雅加達", enName: "Jakarta", lat: -6.2088, lng: 106.8456, aqi: 110, region: "asia"},
            {name: "雪梨", enName: "Sydney", lat: -33.8688, lng: 151.2093, aqi: 27, region: "oceania"},
            {name: "洛杉磯", enName: "Los Angeles", lat: 34.0522, lng: -118.2437, aqi: 60, region: "north-america"},
            {name: "倫敦", enName: "London", lat: 51.5074, lng: -0.1278, aqi: 25, region: "europe"},
            {name: "巴黎", enName: "Paris", lat: 48.8566, lng: 2.3522, aqi: 75, region: "europe"},
            {name: "柏林", enName: "Berlin", lat: 52.5200, lng: 13.4050, aqi: 50, region: "europe"},
            {name: "莫斯科", enName: "Moscow", lat: 55.7558, lng: 37.6173, aqi: 42, region: "europe"},
            {name: "紐約", enName: "New York", lat: 40.7128, lng: -74.0060, aqi: 29, region: "north-america"},
            {name: "墨西哥城", enName: "Mexico City", lat: 19.4326, lng: -99.1332, aqi: 56, region: "north-america"},
            {name: "聖保羅", enName: "Sao Paulo", lat: -23.5505, lng: -46.6333, aqi: 37, region: "south-america"},
            {name: "開羅", enName: "Cairo", lat: 30.0444, lng: 31.2357, aqi: 63, region: "africa"},
            {name: "約翰尼斯堡", enName: "Johannesburg", lat: -26.2041, lng: 28.0473, aqi: 92, region: "africa"}
        ];
        
        let markers = [];
        
        // 根据AQI值获取颜色
        function getAqiColor(aqi) {
            if (aqi <= 50) return '#2ecc71'; // 良好
            if (aqi <= 100) return '#f1c40f'; // 中等
            if (aqi <= 150) return '#e67e22'; // 不健康
            if (aqi <= 200) return '#e74c3c'; // 非常不健康
            return '#8e44ad'; // 危險
        }
        
        // 添加城市标记到地图
        function updateMapMarkers() {
            // 清除现有标记
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            // 添加新标记
            cities.forEach(city => {
                const marker = L.circleMarker([city.lat, city.lng], {
                    radius: Math.max(5, Math.min(12, city.aqi/10)),
                    fillColor: getAqiColor(city.aqi),
                    color: '#fff',
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map);
                
                const popupContent = currentLang === 'zh' ? 
                    `<strong>${city.name}</strong><br>AQI: ${city.aqi}<br>${getAqiDescription(city.aqi, 'zh')}` :
                    `<strong>${city.enName}</strong><br>AQI: ${city.aqi}<br>${getAqiDescription(city.aqi, 'en')}`;
                
                marker.bindPopup(popupContent);
                markers.push(marker);
            });
        }
        
        // 获取AQI描述
        function getAqiDescription(aqi, lang) {
            if (aqi <= 50) return lang === 'zh' ? '空氣質量良好' : 'Good air quality';
            if (aqi <= 100) return lang === 'zh' ? '空氣質量中等' : 'Moderate air quality';
            if (aqi <= 150) return lang === 'zh' ? '對敏感人群不健康' : 'Unhealthy for sensitive groups';
            if (aqi <= 200) return lang === 'zh' ? '不健康' : 'Unhealthy';
            return lang === 'zh' ? '危險' : 'Hazardous';
        }
        
        // 添加图例
        let legend = L.control({position: 'bottomright'});
        
        function updateLegend() {
            if (legend) {
                map.removeControl(legend);
            }
            
            legend = L.control({position: 'bottomright'});
            
            legend.onAdd = function(map) {
                const div = L.DomUtil.create('div', 'info legend');
                const grades = [0, 50, 100, 150, 200];
                const zhLabels = ['良好', '中等', '不健康', '非常不健康', '危險'];
                const enLabels = ['Good', 'Moderate', 'Unhealthy', 'Very Unhealthy', 'Hazardous'];
                const labels = currentLang === 'zh' ? zhLabels : enLabels;
                
                const title = currentLang === 'zh' ? 'AQI图例' : 'AQI Legend';
                
                div.innerHTML = `<div style="background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px;"><strong>${title}</strong></div>`;
                
                for (let i = 0; i < grades.length; i++) {
                    div.innerHTML += `
                        <div style="margin: 5px 0; display: flex; align-items: center;">
                            <div style="background:${getAqiColor(grades[i] + 1)}; width: 15px; height: 15px; border-radius: 50%; margin-right: 5px;"></div>
                            ${grades[i]}${grades[i + 1] ? '&ndash;' + grades[i + 1] : '+'} (${labels[i]})
                        </div>
                    `;
                }
                
                return div;
            };
            
            legend.addTo(map);
        }
        
        // 更新筛选状态文本
        function updateFilterStatus() {
            const regionFilter = document.getElementById('regionFilter');
            const selectedValue = regionFilter.value;
            const filterStatus = document.querySelector('.filter-status');
            
            let statusText = '';
            
            if (selectedValue === 'all') {
                statusText = currentLang === 'zh' ? '顯示全部城市' : 'Showing all cities';
            } else {
                const regionName = regionFilter.options[regionFilter.selectedIndex].textContent;
                statusText = currentLang === 'zh' ? `顯示${regionName}地區城市` : `Showing cities in ${regionName}`;
            }
            
            filterStatus.innerHTML = statusText;
        }
        
        // 初始化地图标记和图例
        updateMapMarkers();
        updateLegend();
        
        // 标签切换功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // 视图切换功能
        document.querySelectorAll('.view-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.view-option').forEach(o => o.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // 区域筛选功能
        document.getElementById('regionFilter').addEventListener('change', function() {
            const region = this.value;
            const cityCards = document.querySelectorAll('.city-card');
            let visibleCount = 0;
            
            // 更新筛选状态文本
            updateFilterStatus();
            
            // 遍历所有城市卡片
            cityCards.forEach(card => {
                if (region === 'all' || card.getAttribute('data-region') === region) {
                    card.style.display = 'block';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            // 如果没有匹配的城市
            if (visibleCount === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'no-alert';
                noResults.innerHTML = `
                    <div class="alert-header">
                        <i class="fas fa-info-circle"></i>
                        <h4>
                            <span class="lang-zh active">未找到匹配城市</span>
                            <span class="lang-en">No matching cities</span>
                        </h4>
                    </div>
                    <p>
                        <span class="lang-zh active">該地區暫無城市數據</span>
                        <span class="lang-en">No city data available for this region</span>
                    </p>
                `;
                
                // 移除现有的提示
                const existingAlert = document.querySelector('.city-cards .no-alert');
                if (existingAlert) existingAlert.remove();
                
                document.querySelector('.city-cards').appendChild(noResults);
            } else {
                // 移除现有的提示
                const existingAlert = document.querySelector('.city-cards .no-alert');
                if (existingAlert) existingAlert.remove();
            }
        });
        
        // 污染物选择功能
        document.getElementById('pollutantSelect').addEventListener('change', function() {
            const pollutant = this.value;
            alert(currentLang === 'zh' ? `已选择污染物: ${pollutant}` : `Pollutant selected: ${pollutant}`);
        });
        
        // 初始化筛选状态
        updateFilterStatus();
        
        // 音乐播放器功能
        const audio = new Audio('https://ping763573.github.io/big-adventure/02.mp3');
        const musicPlayer = document.getElementById('musicPlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const volumeControl = document.getElementById('volumeControl');
        let isPlaying = true;
        
        // 设置初始音量
        audio.volume = volumeControl.value;
        
        // 开始播放音乐
        audio.play().catch(error => {
            console.log('自动播放被阻止:', error);
            isPlaying = false;
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        });
        
        // 播放/暂停按钮
        playPauseBtn.addEventListener('click', function() {
            if (isPlaying) {
                audio.pause();
                this.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                audio.play();
                this.innerHTML = '<i class="fas fa-pause"></i>';
            }
            isPlaying = !isPlaying;
        });
        
        // 音量控制
        volumeControl.addEventListener('input', function() {
            audio.volume = this.value;
        });
        
        // 音乐播放器展开功能
        let expandTimeout;
        musicPlayer.addEventListener('mouseenter', function() {
            clearTimeout(expandTimeout);
            this.classList.add('expanded');
        });
        
        musicPlayer.addEventListener('mouseleave', function() {
            expandTimeout = setTimeout(() => {
                this.classList.remove('expanded');
            }, 1000);
        });
    </script>
</body>
</html>